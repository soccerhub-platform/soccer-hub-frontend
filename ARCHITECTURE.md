# Архитектура Football CRM

Этот документ описывает общую архитектуру фронтенда для CRM футбольной школы. Проект построен на **React 18** с использованием **TypeScript**, **Tailwind CSS** и **React Router 6**. Архитектура ориентирована на модульность и изоляцию функциональных областей.

## Структура каталогов

```
football-crm/
├── src/
│   ├── modules/
│   │   ├── dispatcher/    # Модуль для диспетчеров
│   │   └── admin/         # Модуль для администраторов
│   ├── shared/            # Общие ресурсы и утилиты
│   ├── App.tsx            # Корневой компонент
│   ├── main.tsx           # Точка входа для Vite
│   └── index.css          # Подключение Tailwind
├── index.html              # HTML‑шаблон
├── package.json            # Зависимости и скрипты
├── tailwind.config.js      # Конфигурация Tailwind CSS
└── tsconfig.json           # Конфигурация TypeScript
```

### Модули (`src/modules`)

Каждый модуль представляет собой мини‑приложение со своей страницей входа, маршрутизацией и компонентами. Модули полностью изолированы друг от друга, что позволяет развивать их независимо и масштабировать функциональность:

- **Dispatcher** – интерфейс диспетчера для управления лидами, клиентами и пробными тренировками. Имеет собственную цветовую схему (оттенки синего).
- **Admin** – интерфейс администратора для управления контрактами, платежами и пользовательскими учетными записями. Имеет фиолетовую цветовую схему.

### Общие ресурсы (`src/shared`)

В этой папке находятся переиспользуемые сущности:

- **AuthContext** – контекст для авторизации. Содержит текущего пользователя, методы `login` и `logout`. Пользователь сохраняется в `localStorage`.
- **ProtectedRoute** – компонент для защиты маршрутов. Проверяет наличие пользователя и соответствие роли.
- **api.ts** – конфигурированный экземпляр Axios для общения с сервером. Добавляет заголовок `Authorization` при наличии пользователя.
- **types.ts** – общие типы (клиенты, тренировки, тренеры, пользователи).

### Принцип работы

В корневом компоненте `App.tsx` определены два верхнеуровневых маршрута: `/dispatcher/*` и `/admin/*`. В зависимости от префикса загружается соответствующий модуль. Если пользователь не авторизован или его роль не соответствует модулю, происходит перенаправление на страницу логина.

```tsx
<AuthProvider>
  <Routes>
    <Route path="/dispatcher/*" element={<DispatcherRoutes />} />
    <Route path="/admin/*" element={<AdminRoutes />} />
  </Routes>
</AuthProvider>
```

Каждый модуль имеет свою страницу входа, защищенные маршруты и layout с боковым меню и заголовком. Общая логика (авторизация, типы, API) вынесена в `shared/`.

## Добавление нового модуля

Для расширения CRM дополнительным модулем (например, модуль для тренеров) необходимо создать папку `src/modules/coach` и реализовать:

1. **Страницу входа** (`Login.tsx`) с собственной цветовой схемой.
2. **Layout** (`CoachLayout.tsx`) с боковым меню и `Outlet` для вложенных маршрутов.
3. **Маршруты** (`index.tsx`), оборачивающие защищенные страницы компонентом `ProtectedRoute` и указывающие требуемую роль.

Подключите модуль в `App.tsx` добавив новый `<Route path="/coach/*" element={<CoachRoutes />} />`. Добавьте новую роль в `Role` и обновите `AuthContext`.

## Best practices

- Разделяйте модули по функционалу; не смешивайте код разных ролей.
- Используйте контекст только для общих состояний (например, авторизация). Для данных используйте библиотеку React Query или состояние на уровне компонентов.
- Обновляйте типы в `shared/types.ts` по мере расширения бизнес‑логики.
- Используйте Tailwind для быстрой стилизации и единообразия интерфейса.
